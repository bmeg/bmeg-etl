
class: lathe
name: pathwayCommonsDownload

#scripts:
#  jar:
#    commandLine: docker run  --rm -u `id -u` -v `pwd`:`pwd` -v `pwd`/maven-repo:/root/.m2 -w `pwd` -ti maven:3-openjdk-11 mvn package
#    outputs:
#      - target/pc-extract-1.0-jar-with-dependencies.jar

templates:
  pc-prep:
    inputs:
      - name: "reconx"
      - name: "reactome"
      - name: "psp"
      - name: "pid"
      - name: "pathbank"
      - name: "panther"
      - name: "netpath"
      - name: "msigdb"
      - name: "mirtarbase"
      - name: "kegg"
      #- name: "intact_complex"
      #- name: "intact"
      - name: "inoh"
      - name: "innatedb"
      - name: "humancyc"
      - name: "hprd"
      - name: "drugbank"
      - name: "dip"
      - name: "ctd"
      - name: "corum"
      - name: "biogrid"
      - name: "bind"
    scripts:
      "{{#merge}}":
        "{{#each inputs}}":
          "download_{{name}}":
            commandLine: curl -o ../../source/pathway_commons/PathwayCommons12.{{name}}.BIOPAX.owl.gz https://www.pathwaycommons.org/archives/PC2/v12/PathwayCommons12.{{name}}.BIOPAX.owl.gz
            outputs:
              - ../../source/pathway_commons/PathwayCommons12.{{name}}.BIOPAX.owl.gz
          "process_{{name}}":
            inputs:
              - ../../tools/extsif/target/pc-extract-1.0-jar-with-dependencies.jar
              - ../../source/pathway_commons/PathwayCommons12.{{name}}.BIOPAX.owl.gz
            # conda install -c conda-forge openjdk=11
            # docker run  --rm -u `id -u` -v `pwd`/../../:`pwd`/../../ -w `pwd` openjdk:11 
            commandLine: java -Xmx15g -jar ../../tools/extsif/target/pc-extract-1.0-jar-with-dependencies.jar ../../source/pathway_commons/PathwayCommons12.{{name}}.BIOPAX.owl.gz ../../source/pathway_commons/PathwayCommons12.{{name}}
            memMB: 15000
            outputs:
              - ../../source/pathway_commons/PathwayCommons12.{{name}}.extSIF
              - ../../source/pathway_commons/PathwayCommons12.{{name}}.complex
      concat:
        inputs:
          "{{#each inputs}}" :
              "../../source/pathway_commons/PathwayCommons12.{{name}}.extSIF"
        outputs:
          "../../source/pathway_commons/PathwayCommons12.ALL.extSIF"
        commandLine:
          "cat {input} > ../../source/pathway_commons/PathwayCommons12.ALL.extSIF"
