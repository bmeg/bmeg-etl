
class: lathe
name: pathwayCommonsDownload

#scripts:
#  jar:
#    commandLine: docker run  --rm -u `id -u` -v `pwd`:`pwd` -v `pwd`/maven-repo:/root/.m2 -w `pwd` -ti maven:3-openjdk-11 mvn package
#    outputs:
#      - target/pc-extract-1.0-jar-with-dependencies.jar

scripts: {}

templates:
  pc-prep:
    inputs:
      - name: "reconx"
      - name: "reactome"
      - name: "psp"
      - name: "pid"
      - name: "pathbank"
      - name: "panther"
      - name: "netpath"
      - name: "msigdb"
      - name: "mirtarbase"
      - name: "kegg"
      #- name: "intact_complex"
      #- name: "intact"
      - name: "inoh"
      - name: "innatedb"
      - name: "humancyc"
      - name: "hprd"
      - name: "drugbank"
      - name: "dip"
      - name: "ctd"
      - name: "corum"
      - name: "biogrid"
      - name: "bind"
    scripts:
      "{{#merge}}":
        "{{#each inputs}}":
          "download_{{name}}":
            commandLine: "curl -o \\{{outputs.gz}} https://www.pathwaycommons.org/archives/PC2/v12/PathwayCommons12.{{name}}.BIOPAX.owl.gz"
            outputs:
              gz: "../../source/pathway_commons/PathwayCommons12.{{name}}.BIOPAX.owl.gz"
          "process_{{name}}":
            inputs:
              jar: ../../util/extsif/target/pc-extract-1.0-jar-with-dependencies.jar
              gz: "../../source/pathway_commons/PathwayCommons12.{{name}}.BIOPAX.owl.gz"
            # conda install -c conda-forge openjdk=11
            # docker run  --rm -u `id -u` -v `pwd`/../../:`pwd`/../../ -w `pwd` openjdk:11 
            commandLine: java -Xmx15g -jar \{{inputs.jar}} \{{inputs.gz}} ../../source/pathway_commons/PathwayCommons12.{{name}}
            memMB: 15000
            outputs:
              extSif: ../../source/pathway_commons/PathwayCommons12.{{name}}.extSIF
              complex: ../../source/pathway_commons/PathwayCommons12.{{name}}.complex
      concat:
        inputs:
          "{{#merge}}":
            "{{#each inputs}}" :
                "{{name}}": "../../source/pathway_commons/PathwayCommons12.{{name}}.extSIF"
        outputs:
          outSif: "../../source/pathway_commons/PathwayCommons12.ALL.extSIF"
        commandLine:
          "cat {input} > \\{{outputs.outSif}}"
